<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UESCAN - Upper East Side Collective Action Network</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">

    <style>
        :root {
            --pri-green: #00933C;
            --pri-orange: #EB6800;
            --pri-yellow: #F6BC26;
            --back-green: #E6F7EB;
            --back-orange: #FDF0E6;
            --back-yellow: #FFF9E6;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            font-optical-sizing: auto;
            font-weight: 400;
            font-style: normal;
            margin: 0;
            padding: 0;
            background-color: var(--back-orange);
            color: #333;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header */
        header {
            /* background: rgba(255, 255, 255, 0.9); */
            background: var(--back-green);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--pri-green);
            /* padding: 0.1rem 0; */
            /* position: sticky; */
            top: 0;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        /* center header content: logo and nav */
       

        /* ensure the logo block is centered */
        header img {
            display: block;
            margin: 2rem auto;
            text-align: center;
            height:150px;
            width:auto;
        }

        /* center the nav items */
        header nav ul {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
        }

        /* keep header compact on small screens */
        @media (max-width: 768px) {
            header {
                padding: 0.75rem 0;
            }
        }

        /* .logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-dark);
            text-decoration: none;
        } */

        nav ul {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        nav a {
            color: var(--pri-green);
            text-decoration: none;
            transition: color 0.3s;
            text-align: center;
            font-weight: bold;
        }

        nav a:hover {
            color: var(--pri-green);
            text-align: center;
            text-decoration: underline;
        }
        
        /* Main Content */
        main {
            min-height: calc(100vh - 200px);
            padding: 2rem 0;
        }

        .content-area {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border-color: var(--pri-orange);
            border-width: 4px;
            border-style: solid;
            padding: 2rem;
            margin: 2rem 0;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-light);
        }

        .error {
            background: #FEE;
            color: #C53030;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .last-updated {
            background: rgba(255, 255, 255, 0.6);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--text-light);
            text-align: center;
            margin-bottom: 2rem;
        }

        /* Notion Content Styles */
        .notion-content h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--text-dark);
            border-bottom: 3px solid var(--pastel-blue);
            padding-bottom: 0.5rem;
            color: var(--pri-orange);
        }

        .notion-content h2 {
            font-size: 2rem;
            margin: 2rem 0 1rem 0;
            color: var(--pri-orange);
        }
        

        .notion-content h3 {
            font-size: 1.5rem;
            margin: 1.5rem 0 0.5rem 0;
            color: var(--text-light);
        }

        .notion-content p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .notion-content ul, .notion-content ol {
            margin: 1rem 0 1rem 2rem;
        }

        .notion-content li {
            margin-bottom: 0.5rem;
        }

        .notion-content a {
            color: #3182CE;
            text-decoration: none;
        }

        .notion-content a:hover {
            text-decoration: underline;
        }

        .notion-content blockquote {
            border-left: 4px solid var(--pastel-green);
            padding-left: 1rem;
            margin: 1rem 0;
            font-style: italic;
            background: rgba(255, 255, 255, 0.5);
            padding: 1rem;
            border-radius: 8px;
        }
        /* Footer */
        footer {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .footer-content {
            text-align: center;
            color: var(--text-light);
        }

        .footer-content p {
            margin-bottom: 0.5rem;
        }
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            nav ul {
                gap: 1rem;
            }

            .logo {
                font-size: 1.5rem;
            }

            .content-area {
                padding: 1rem;
                margin: 1rem 0;
            }
        }

        /* Animations */
        .fade-in {
            opacity: 0;
            animation: fadeIn 0.5s ease-in forwards;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

    </style>
</head>
<body>
    <header>
        <a href="./index1.html" class="logo" aria-label="UESCAN home">
            <img src="images/uescan_logo.png" alt="UESCAN logo">
        </a>
        <nav>
            <ul>
                <!-- <li><a href="#about">About</a></li> -->
                <li><a href="#our-history">History</a></li>
                <li><a href="#initiatives">Initiatives</a></li>
                <li><a href="#join-us">Join Us!</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div class="container">
            <div class="content-area">
                <h1>Upper East Side Collective Action Network</h1>
                <div id="content-loading" class="loading">
                    <p>Loading community content...</p>
                </div>
                
                <div id="content-error" class="error" style="display: none;">
                    <p>Unable to load community content. Please check back later.</p>
                </div>
                
                <div id="notion-content" class="notion-content" style="display: none;">
                    <!-- Content will be loaded here -->
                </div>

                <div id="last-updated" class="last-updated" style="display: none;">
                    <!-- Last updated timestamp will appear here -->
                </div>
            </div>
        </div>
    </main>
    <footer>
        <div class="container">
            <div class="footer-content">
                <p><strong>UESCAN</strong> - Upper East Side Collective Action Network</p>
                <p>Building community through mutual support</p>
                <p>Content updated daily from our community editors</p>
            </div>
        </div>
    </footer> 
    
    <script>
        (async function() {
            const CONTENT_PATH = './content/notion-content.json';
            const FETCH_TIMEOUT_MS = 8000;

            // Helper: create URL-safe slug for headings
            function slugify(text) {
                return (text || '')
                    .toString()
                    .toLowerCase()
                    .trim()
                    .replace(/[\s\_]+/g, '-')
                    .replace(/[^a-z0-9\-]+/g, '')
                    .replace(/\-+/g, '-')
                    .replace(/^\-+|\-+$/g, '');
            }

            // Add IDs to H2s inside .notion-content (uses slug of the text)
            function addHeadingIds(container = document) {
                container.querySelectorAll('.notion-content h2').forEach(h2 => {
                    if (!h2.id) {
                        const id = slugify(h2.textContent);
                        if (id) h2.id = id;
                    }
                });
            }

            // Load static content generated by GitHub Actions (with timeout & fallback)
            async function loadContent() {
                const loadingEl = document.getElementById('content-loading');
                const errorEl = document.getElementById('content-error');
                const contentEl = document.getElementById('notion-content');
                const lastUpdatedEl = document.getElementById('last-updated');

                // show initial UI state
                loadingEl.style.display = 'block';
                errorEl.style.display = 'none';
                contentEl.style.display = 'none';
                lastUpdatedEl.style.display = 'none';

                const controller = new AbortController();
                const timeout = setTimeout(() => controller.abort(), FETCH_TIMEOUT_MS);

                try {
                    const resp = await fetch(CONTENT_PATH, { signal: controller.signal, cache: 'no-cache' });
                    clearTimeout(timeout);

                    if (!resp.ok) throw new Error('Fetch failed: ' + resp.status);

                    const data = await resp.json();

                    // set last-updated if present
                    if (data.lastUpdated) {
                        try {
                            const t = new Date(data.lastUpdated);
                            if (!Number.isNaN(t.getTime())) {
                                lastUpdatedEl.textContent = `Last updated: ${t.toLocaleString()}`;
                                lastUpdatedEl.style.display = 'block';
                            }
                        } catch (e) { /* ignore timestamp parse errors */ }
                    }

                    // insert content (fall back to generateFallbackContent if missing)
                    contentEl.innerHTML = data.content && String(data.content).trim()
                        ? data.content
                        : generateFallbackContent();

                    addHeadingIds(document);

                    loadingEl.style.display = 'none';
                    contentEl.style.display = 'block';
                    contentEl.classList.add('fade-in');

                } catch (err) {
                    clearTimeout(timeout);
                    loadingEl.style.display = 'none';

                    // Fallback: try to render built-in fallback content
                    try {
                        contentEl.innerHTML = generateFallbackContent();
                        addHeadingIds(document);
                        contentEl.style.display = 'block';
                        contentEl.classList.add('fade-in');
                        // optionally show last-updated not available
                    } catch (fallbackErr) {
                        console.error('Fallback content failed:', fallbackErr);
                        errorEl.style.display = 'block';
                    }
                }
            }

            // Expose functions to global scope if needed for debugging (non-enumerable)
            Object.defineProperty(window, '__uescan_loadContent__', { value: loadContent, writable: false, configurable: true });
            Object.defineProperty(window, '__uescan_addHeadingIds__', { value: addHeadingIds, writable: false, configurable: true });

            // Ensure loadContent is available when DOMContentLoaded handler below calls it
            window.loadContent = loadContent;
            window.addHeadingIds = addHeadingIds;
        })();

        function generateFallbackContent() {
            return `
                <h1>UESCAN - Upper East Side Collective Action Network</h1>
                <p>Building community through mutual support</p>
                
                <h2>About Our Network</h2>
                <p>UES CAN was co-founded in July 2025 by 20+ neighbors, many of whom first convened in late 2024 over concerns about increased state repression. We organized ourselves into a mutual aid group, creating a space in which every voice matters and decisions are made collectively to directly impact our community. Our early initiatives included providing food & water to neighbors and raising funds to support those in need.</p>
                
                <h2>How We Help</h2>
                <ul>
                    <li><strong>Food Security:</strong> Community gardens, food pantries, and meal sharing programs</li>
                    <li><strong>Housing Support:</strong> Tenant rights education, housing advocacy, and temporary assistance</li>
                    <li><strong>Community Building:</strong> Neighborhood events, skill shares, and organizing support</li>
                    <li><strong>Resource Sharing:</strong> Tool libraries, clothing swaps, and mutual aid networks</li>
                </ul>
                
                <h2>Get Involved</h2>
                <p>Whether you need support or want to help others, there's a place for you in UESCAN. Community members collaborate to keep our resources up to date and responsive to neighborhood needs.</p>
                
                <blockquote>
                    <p>“Activism and mutual aid shouldn’t feel like volunteering or like a hobby -- it should feel like living in alignment with our hopes for the world and with our passions. It should enliven us.” - Our content is maintained by community volunteers working together.</p>
                </blockquote>
                
                <p><em>Note: Our content is automatically updated daily from community editors. If you're seeing this message, the latest content may still be processing.</em></p>
            `;
        }

        // Smooth scrolling for navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Load content on page load
            loadContent();

            // Add smooth scrolling to navigation links
            document.querySelectorAll('nav a[href^="#"]').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').slice(1);
                    const targetElement = document.getElementById(targetId);
                    
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
        });
    </script>
</body>
</html>